<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>R-Type Game Engine: Proof of Concept: Choice of SFML for R-Type Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">R-Type Game Engine<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Documentation de l&#39;ECS et des systèmes pour le projet R-Type</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_poc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Proof of Concept: Choice of SFML for R-Type Project</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md25"></a> </p>
<h1><a class="anchor" id="autotoc_md26"></a>
1. Introduction</h1>
<p>This document outlines the technical reasoning behind choosing <b>SFML (Simple and Fast Multimedia Library)</b> for the R-Type project, specifically focusing on architectural fit and networking capabilities compared to major alternatives (SDL2, Raylib, Qt).</p>
<h1><a class="anchor" id="autotoc_md27"></a>
2. Comparison with Alternatives</h1>
<h2><a class="anchor" id="autotoc_md28"></a>
A. SFML vs. SDL2 (Simple DirectMedia Layer)</h2>
<ul>
<li><b>Language Paradigm:</b> SDL2 is a <b>C library</b>. It requires manual memory management (destroying textures/windows) and pointer handling. SFML is a <b>C++ library</b> that uses RAII (Resource Acquisition Is Initialization), meaning resources are automatically cleaned up when they go out of scope.</li>
<li><b>Networking:</b> SDL2 is strictly a media layer (Graphics, Audio, Input). It <b>does not</b> have a networking module. To use SDL2, we would need to integrate a separate, complex library like <code>Boost.Asio</code> or raw OS sockets.</li>
<li><b>Architecture:</b> SFML's Object-Oriented design (<code>sf::Sprite</code>, <code>sf::Texture</code>) aligns perfectly with the C++ Class-based architecture of our <a class="el" href="classECS.html" title="Entity Component System manager.">ECS</a> (Entity Component System). SDL2's procedural C style would require writing extensive C++ wrappers.</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
B. SFML vs. Raylib</h2>
<ul>
<li><b>Rendering Paradigm:</b> Raylib often uses "Immediate Mode" rendering (drawing commands issued every frame procedurally). While powerful for prototyping, this can conflict with the strict state management required in a distributed multiplayer game. SFML's "Retained Mode" style (configuring objects and drawing them) fits better with persistent game entities.</li>
<li><b>Networking:</b> Like SDL2, Raylib is primarily for graphics and audio. It lacks a robust, built-in object-oriented networking class compatible with C++ streams.</li>
<li><b>Language:</b> Raylib is C-based. Using it in a C++20 project means losing out on modern C++ features (references, classes, templates) in the graphics layer.</li>
</ul>
<h2><a class="anchor" id="autotoc_md30"></a>
C. SFML vs. Qt (Qt 6)</h2>
<ul>
<li><b>Performance:</b> Qt is a heavy application framework designed for GUIs, not real-time arcade games. Its event loop and Signal/Slot mechanism introduce significant overhead compared to SFML's lightweight <code>pollEvent</code> loop.</li>
<li><b>Architecture Control:</b> Qt enforces a strict architecture (<code>QObject</code> hierarchy, <code>moc</code> compiler). SFML is "passive," allowing us to build our own custom architecture (like the <a class="el" href="classECS.html" title="Entity Component System manager.">ECS</a> in <code>include/ecs.hpp</code>) without framework interference.</li>
<li><b>Complexity:</b> Qt includes tools for everything (WebEngine, SQL, XML), which is unnecessary bloat for a game client/server.</li>
</ul>
<h1><a class="anchor" id="autotoc_md31"></a>
3. Why SFML is the Superior Choice for R-Type</h1>
<h2><a class="anchor" id="autotoc_md32"></a>
A. Unified Networking &amp; Graphics</h2>
<p>SFML is unique among lightweight libraries because it provides <b>Graphics, Audio, and Networking</b> in a single cohesive package.</p><ul>
<li><b>Benefit:</b> We do not need to manage two separate dependencies (e.g., SDL for graphics + Boost for network).</li>
<li><b>Synergy:</b> We can use <code>sf::IpAddress</code> and <code>sf::UdpSocket</code> on the server, and <code>sf::RenderWindow</code> on the client, all sharing the same style and conventions.</li>
</ul>
<h2><a class="anchor" id="autotoc_md33"></a>
B. Protocol &amp; Serialization (&lt;tt&gt;sf::Packet&lt;/tt&gt;)</h2>
<ul>
<li><b>Endianness:</b> SFML's <code>sf::Packet</code> automatically handles "Endianness" (byte order) conversion. This ensures that a Linux <a class="el" href="classServer.html">Server</a> and a Windows <a class="el" href="classClient.html">Client</a> can communicate integers and floats without data corruption.</li>
<li><b>Ease of Use:</b> We can stream data directly into packets (<code>packet &lt;&lt; x &lt;&lt; y;</code>) without complex pointer arithmetic or <code>memcpy</code> operations required by raw sockets.</li>
</ul>
<h2><a class="anchor" id="autotoc_md34"></a>
C. Modern C++ Compatibility</h2>
<ul>
<li>Our project uses <b>C++20</b>. SFML is written in C++ and supports modern idioms naturally.</li>
<li>It integrates seamlessly with <code>std::shared_ptr</code> and <code>std::vector</code>, which are heavily used in our <a class="el" href="classECS.html" title="Entity Component System manager.">ECS</a> and Entity <a class="el" href="namespaceFactory.html">Factory</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md35"></a>
D. Development Velocity</h2>
<ul>
<li>SFML abstracts away low-level OpenGL and Socket API calls, allowing the team to focus on Game Logic (<a class="el" href="classECS.html" title="Entity Component System manager.">ECS</a>, Physics, Wave Systems) rather than boilerplate code.</li>
</ul>
<h1><a class="anchor" id="autotoc_md36"></a>
4. Architectural Study: ECS vs. OOP</h1>
<h2><a class="anchor" id="autotoc_md37"></a>
A. Traditional OOP (Object-Oriented Programming)</h2>
<ul>
<li><b>Structure:</b> Uses deep inheritance hierarchies (e.g., <code>GameObject</code> -&gt; <code>Movable</code> -&gt; <code>Enemy</code> -&gt; <code>Boss</code>).</li>
<li><b>The Problem (Diamond of Death):</b> If we want an entity that is both a "Building" and "Movable" (like a flying fortress), we run into multiple inheritance issues.</li>
<li><b>Memory:</b> Objects are often scattered in heap memory, causing "cache misses" as the CPU jumps around to find data.</li>
<li><b>Coupling:</b> Logic (methods) and Data (member variables) are tightly bound in the same class.</li>
</ul>
<h2><a class="anchor" id="autotoc_md38"></a>
B. ECS (Entity Component System) - Chosen for R-Type</h2>
<ul>
<li><b>Structure:</b><ul>
<li><b>Entity:</b> Just a unique ID (uint32).</li>
<li><b>Component:</b> Pure data (Position, Velocity, Sprite, Health). No logic.</li>
<li><b>System:</b> Pure logic (<a class="el" href="classMovementSystem.html">MovementSystem</a>, <a class="el" href="classRenderSystem.html">RenderSystem</a>). Iterates over entities that have specific components.</li>
</ul>
</li>
<li><b>Composition over Inheritance:</b> We build entities by "plugging in" components. A "Flying Fortress" is just an Entity with <code>Position</code>, <code>Sprite</code>, and <code>Velocity</code> components. No complex inheritance needed.</li>
<li><b>Performance (Data Locality):</b> <a class="el" href="namespaceComponents.html" title="Espace dédié pour tous les composants ECS.">Components</a> of the same type are stored in contiguous arrays. This allows the CPU to prefetch data efficiently, drastically improving performance for games with many objects (like bullets in R-Type).</li>
<li><b>Network Serialization:</b> Since <a class="el" href="namespaceComponents.html" title="Espace dédié pour tous les composants ECS.">Components</a> are POD (Plain Old Data) structs, they are trivial to serialize and send over the network compared to complex OOP objects with vtables.</li>
</ul>
<h1><a class="anchor" id="autotoc_md39"></a>
5. Algorithms &amp; Data Structures</h1>
<h2><a class="anchor" id="autotoc_md40"></a>
A. Algorithms</h2>
<ul>
<li><b>Collision Detection (AABB):</b> We use Axis-Aligned Bounding Box collision detection (<code>sf::FloatRect::intersects</code>). This is an $O(N^2)$ algorithm in its simplest form, iterating through entity pairs. While simple, it is sufficient for the entity count in R-Type (&lt; 2048).</li>
<li><b>System Iteration:</b> Systems iterate over entities matching a specific <code>Signature</code> (Bitset). This is an $O(N)$ operation where N is the number of entities with that specific component combination.</li>
</ul>
<h2><a class="anchor" id="autotoc_md41"></a>
B. Data Structures</h2>
<ul>
<li><b>Bitsets (<code>std::bitset</code>):** Used for Entity Signatures to quickly check if an entity has the required components for a system (O(1) check).</b></li>
<li><b> **Contiguous Arrays (<code>std::vector</code>):** <a class="el" href="namespaceComponents.html" title="Espace dédié pour tous les composants ECS.">Components</a> are stored in dense arrays to maximize cache locality.</b></li>
<li><b> **Thread-Safe Queues (<code><a class="el" href="classSafeQueue.html">SafeQueue</a></code>):** A custom thread-safe queue using <code>std::mutex</code> and <code>std::condition_variable</code> is used to buffer network packets between the <a class="el" href="classUDP.html">UDP</a> reception thread and the main game loop.</b></li>
</ul>
<p><b></b></p>
<h1><a class="anchor" id="autotoc_md42"></a>
6. Network Protocol &amp; Reliability</h1>
<p><b></b></p>
<p><b></b></p>
<h2><a class="anchor" id="autotoc_md43"></a>
A. Hybrid Protocol Strategy</h2>
<p><b></p><ul>
<li><b><a class="el" href="classUDP.html">UDP</a> (User Datagram Protocol):</b> Used for high-frequency, low-latency data:<ul>
<li><b><a class="el" href="classClient.html">Client</a> -&gt; <a class="el" href="classServer.html">Server</a>:</b> <code><a class="el" href="structInputState.html">InputState</a></code> (Player inputs).</li>
<li><b><a class="el" href="classServer.html">Server</a> -&gt; <a class="el" href="classClient.html">Client</a>:</b> <code><a class="el" href="structEntityUpdate.html">EntityUpdate</a></code> (Positions, Health).</li>
<li><b>Reliability:</b> We accept packet loss for movement data because a newer packet will arrive ~16ms later (60Hz), making the old one obsolete.</li>
</ul>
</li>
<li><b>TCP (Transmission Control Protocol):</b> Used for critical, low-frequency events:<ul>
<li>Connection/Disconnection.</li>
<li>Lobby Management.</li>
<li>Reliability is guaranteed by TCP itself.</li>
</ul>
</li>
</ul>
<p></b></p>
<p><b></b></p>
<h2><a class="anchor" id="autotoc_md44"></a>
B. Protocol Documentation (RFC Style)</h2>
<p><b> The protocol is documented in <code>rfcprotocol.txt</code>, defining packet structures in Big-Endian format.</p><ul>
<li><b><a class="el" href="structInputState.html">InputState</a>:</b> 3 bytes (ID + Buttons).</li>
<li><b><a class="el" href="structEntityUpdate.html">EntityUpdate</a>:</b> Packed struct with ID, X, Y coordinates.</li>
</ul>
<p></b></p>
<p><b></b></p>
<h1><a class="anchor" id="autotoc_md45"></a>
7. Security &amp; Data Integrity</h1>
<p><b></b></p>
<p><b></b></p>
<h2><a class="anchor" id="autotoc_md46"></a>
A. Vulnerabilities</h2>
<p><b></p><ul>
<li><b><a class="el" href="classUDP.html">UDP</a> Spoofing:</b> Since <a class="el" href="classUDP.html">UDP</a> is connectionless, an attacker could forge packets with a victim's Player ID.</li>
<li>**Replay Attacks: Capturing valid packets and resending them to simulate movement.</li>
<li><b>Plaintext:</b> Data is currently sent unencrypted.</li>
</ul>
<p></b></p>
<p><b></b></p>
<h2><a class="anchor" id="autotoc_md47"></a>
B. Mitigation &amp; Monitoring</h2>
<p><b></p><ul>
<li><b>Source Validation:</b> The server validates that the <code>sf::IpAddress</code> and Port of the incoming <a class="el" href="classUDP.html">UDP</a> packet match the registered client for that Player ID.</li>
<li><b>Future Security (Long Term):</b><ul>
<li><b>Sequence Numbers:</b> To prevent replay attacks, we will implement a rolling sequence number in the <a class="el" href="classUDP.html">UDP</a> header.</li>
<li><b>Token Authentication:</b> A session token exchanged via TCP during handshake will be required in <a class="el" href="classUDP.html">UDP</a> packets.</li>
<li><b>Sanity Checks:</b> The server enforces game logic (e.g., max speed) to prevent "speed hacks" even if the client sends modified coordinates.</li>
</ul>
</li>
</ul>
<p></b></p>
<p><b></b></p>
<h1><a class="anchor" id="autotoc_md48"></a>
8. Documentation Strategy</h1>
<p><b></p><ul>
<li><b>Technical Documentation:</b> We use Markdown (<code>.md</code>) files in the repository for architectural decisions (like this POC).</li>
<li><b>Protocol Documentation:</b> The network protocol is strictly defined in <code>rfcprotocol.txt</code> to ensure any client (even non-SFML ones) can implement the standard.</li>
<li><b>Code Documentation:</b> Doxygen-style comments are used in headers (<code>.hpp</code>) to describe classes and methods. </li>
</ul>
<p></b></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
